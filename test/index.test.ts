import { TextEncoder, TextDecoder } from 'util';
Object.assign(global, { TextDecoder, TextEncoder });

import { verify } from '../src';

const messageFixture = {
  "nonce": "0428e3865755606a95be4ce1bb9886ea67377258dc210a28132c51c38f5af949",
  "timestamp": 1717759372
};
const proofJWTFixture = 'expires2024+06+07T112752033Zmessagenonce0428e3865755606a95be4ce1bb9886ea67377258dc210a28132c51c38f5af949timestamp1717759370=.eyJkZWxlZ2F0aW9uIjp7InB1YmtleSI6eyIwIjoxMjMsIjEiOjI2LCIyIjo5OCwiMyI6MTczLCI0IjoyMzUsIjUiOjU0LCI2IjoyMTEsIjciOjExMCwiOCI6NjIsIjkiOjIxMSwiMTAiOjE3NSwiMTEiOjE4MCwiMTIiOjIzNywiMTMiOjYxLCIxNCI6MTE3LCIxNSI6MjE5LCIxNiI6MTkwLCIxNyI6MTE4LCIxOCI6MjExLCIxOSI6MTI1LCIyMCI6MjE3LCIyMSI6MTUzLCIyMiI6MjM1LCIyMyI6NDQsIjI0IjoxMDYsIjI1Ijo3LCIyNiI6MTY3LCIyNyI6MTYyLCIyOCI6MTE5LCIyOSI6MzAsIjMwIjoyMTEsIjMxIjoxNDEsIjMyIjoxODgsIjMzIjoxMjMsIjM0IjoxMjcsIjM1Ijo1OCwiMzYiOjIzMSwiMzciOjE5MCwiMzgiOjEyMSwiMzkiOjIzNSwiNDAiOjc4LCI0MSI6MTU0LCI0MiI6MjQ3LCI0MyI6MTUwLCI0NCI6MjIyLCI0NSI6MjI1LCI0NiI6MTk5LCI0NyI6MTgxLCI0OCI6MTA5LCI0OSI6MTkxLCI1MCI6MTI0LCI1MSI6MjQzLCI1MiI6MTY3LCI1MyI6MTU0LCI1NCI6MjM1LCI1NSI6MTg5LCI1NiI6MjUxLCI1NyI6MjM5LCI1OCI6MTEwLCI1OSI6MTI0LCI2MCI6MTE3LCI2MSI6MjA1LCI2MiI6MTgxLCI2MyI6MjA5LCI2NCI6MTczLCI2NSI6MTg4LCI2NiI6MjE1LCI2NyI6MTI1LCI2OCI6MTU2LCI2OSI6MjMxLCI3MCI6ODcsIjcxIjo1NSwiNzIiOjI0MSwiNzMiOjI1NCwiNzQiOjkwLCI3NSI6MTI3LCI3NiI6MjIyLCI3NyI6NjEsIjc4IjoxODIsIjc5Ijo0MSwiODAiOjE1OCwiODEiOjE3OCwiODIiOjIxNCwiODMiOjE2NiwiODQiOjE2NywiODUiOjk0LCI4NiI6MjQ1LCI4NyI6MjM5LCI4OCI6MTkwLCI4OSI6MTI1LCI5MCI6MjIzLCI5MSI6MTg5fSwiZXhwaXJhdGlvbiI6IjE3MTc3NjExNzg1MDc4NjkxMTEifSwic2lnbmF0dXJlIjp7IjAiOjIxNywiMSI6MjE3LCIyIjoyNDcsIjMiOjE2MiwiNCI6MTA3LCI1Ijo5OSwiNiI6MTAxLCI3IjoxMTQsIjgiOjExNiwiOSI6MTA1LCIxMCI6MTAyLCIxMSI6MTA1LCIxMiI6OTksIjEzIjo5NywiMTQiOjExNiwiMTUiOjEwMSwiMTYiOjg5LCIxNyI6MSwiMTgiOjI1MywiMTkiOjIxNywiMjAiOjIxNywiMjEiOjI0NywiMjIiOjE2MiwiMjMiOjEwMCwiMjQiOjExNiwiMjUiOjExNCwiMjYiOjEwMSwiMjciOjEwMSwiMjgiOjEzMSwiMjkiOjEsIjMwIjoxMzEsIjMxIjoxLCIzMiI6MTMxLCIzMyI6MSwiMzQiOjEzMCwiMzUiOjQsIjM2Ijo4OCwiMzciOjMyLCIzOCI6MzgsIjM5IjoxMjUsIjQwIjoxNiwiNDEiOjEzOSwiNDIiOjEzMCwiNDMiOjgxLCI0NCI6NzMsIjQ1IjoyMDAsIjQ2IjoxMzcsIjQ3IjozNCwiNDgiOjEyNywiNDkiOjM0LCI1MCI6MTIsIjUxIjoxNjIsIjUyIjoxLCI1MyI6MTksIjU0IjoxNDAsIjU1IjoyMzAsIjU2IjozMywiNTciOjE5NSwiNTgiOjI4LCI1OSI6MTI0LCI2MCI6NjAsIjYxIjoyNDEsIjYyIjoxMTYsIjYzIjoxNywiNjQiOjEyNiwiNjUiOjExMiwiNjYiOjIxLCI2NyI6MTcsIjY4IjoxMSwiNjkiOjE4MywiNzAiOjEzMSwiNzEiOjIsIjcyIjo3MiwiNzMiOjk5LCI3NCI6OTcsIjc1IjoxMTAsIjc2IjoxMDUsIjc3IjoxMTUsIjc4IjoxMTYsIjc5IjoxMDEsIjgwIjoxMTQsIjgxIjoxMzEsIjgyIjoxLCI4MyI6MTMwLCI4NCI6NCwiODUiOjg4LCI4NiI6MzIsIjg3Ijo0MSwiODgiOjEzMCwiODkiOjE0OCwiOTAiOjIwNiwiOTEiOjIwOCwiOTIiOjM3LCI5MyI6MjM3LCI5NCI6MTU2LCI5NSI6NTQsIjk2IjoxOCwiOTciOjI0NSwiOTgiOjgsIjk5IjoyNDksIjEwMCI6MTU1LCIxMDEiOjEwLCIxMDIiOjIxNywiMTAzIjo3OSwiMTA0IjoxODUsIjEwNSI6MTgsIjEwNiI6MTU2LCIxMDciOjI0NywiMTA4IjoxNzksIjEwOSI6MzMsIjExMCI6MTM2LCIxMTEiOjYzLCIxMTIiOjIwNSwiMTEzIjo3NCwiMTE0IjoyMTYsIjExNSI6MTUxLCIxMTYiOjE2OSwiMTE3IjoxMzQsIjExOCI6OTUsIjExOSI6MTMxLCIxMjAiOjEsIjEyMSI6MTMwLCIxMjIiOjQsIjEyMyI6ODgsIjEyNCI6MzIsIjEyNSI6NTYsIjEyNiI6OTUsIjEyNyI6NzIsIjEyOCI6MTA4LCIxMjkiOjE5MCwiMTMwIjoyNTUsIjEzMSI6MjAxLCIxMzIiOjI1MywiMTMzIjoxNjMsIjEzNCI6MTgxLCIxMzUiOjExMywiMTM2Ijo0NCwiMTM3IjoyMDUsIjEzOCI6MjA3LCIxMzkiOjE1OCwiMTQwIjoxMjAsIjE0MSI6NywiMTQyIjoyNSwiMTQzIjo3OSwiMTQ0IjoxLCIxNDUiOjQwLCIxNDYiOjE1NywiMTQ3IjoxMDcsIjE0OCI6NDksIjE0OSI6ODQsIjE1MCI6MjE1LCIxNTEiOjEzNSwiMTUyIjoxNDEsIjE1MyI6MTc2LCIxNTQiOjM3LCIxNTUiOjE5NiwiMTU2Ijo4LCIxNTciOjEzMSwiMTU4IjoxLCIxNTkiOjEzMSwiMTYwIjoxLCIxNjEiOjEzMCwiMTYyIjo0LCIxNjMiOjg4LCIxNjQiOjMyLCIxNjUiOjY1LCIxNjYiOjEzNiwiMTY3Ijo0MywiMTY4IjoxOTIsIjE2OSI6MTk4LCIxNzAiOjc5LCIxNzEiOjkyLCIxNzIiOjIzNSwiMTczIjoyMjAsIjE3NCI6MjM2LCIxNzUiOjk3LCIxNzYiOjIxNCwiMTc3IjoyMjEsIjE3OCI6ODQsIjE3OSI6MTc2LCIxODAiOjIwMCwiMTgxIjoxMDUsIjE4MiI6MjU1LCIxODMiOjIxNywiMTg0IjoyMTAsIjE4NSI6NTAsIjE4NiI6MjE3LCIxODciOjE0MSwiMTg4Ijo3MiwiMTg5IjoyNTEsIjE5MCI6MjcsIjE5MSI6NTgsIjE5MiI6NzIsIjE5MyI6MjQ5LCIxOTQiOjc3LCIxOTUiOjIzNywiMTk2IjoxMzAsIjE5NyI6MTMxLCIxOTgiOjIsIjE5OSI6NzQsIjIwMCI6MTI4LCIyMDEiOjAsIjIwMiI6MCwiMjAzIjowLCIyMDQiOjAsIjIwNSI6MTYsIjIwNiI6MCwiMjA3IjoxMywiMjA4IjoxLCIyMDkiOjEsIjIxMCI6MTMxLCIyMTEiOjEsIjIxMiI6MTMxLCIyMTMiOjEsIjIxNCI6MTMxLCIyMTUiOjIsIjIxNiI6NzgsIjIxNyI6OTksIjIxOCI6MTAxLCIyMTkiOjExNCwiMjIwIjoxMTYsIjIyMSI6MTA1LCIyMjIiOjEwMiwiMjIzIjoxMDUsIjIyNCI6MTAxLCIyMjUiOjEwMCwiMjI2Ijo5NSwiMjI3IjoxMDAsIjIyOCI6OTcsIjIyOSI6MTE2LCIyMzAiOjk3LCIyMzEiOjEzMCwiMjMyIjozLCIyMzMiOjg4LCIyMzQiOjMyLCIyMzUiOjIyOCwiMjM2IjozOCwiMjM3Ijo1OCwiMjM4IjoxMjMsIjIzOSI6MjQyLCIyNDAiOjI1MSwiMjQxIjo3NSwiMjQyIjoxMTEsIjI0MyI6MTk2LCIyNDQiOjE4OCwiMjQ1IjozMSwiMjQ2IjoxMDgsIjI0NyI6MTcsIjI0OCI6MjUwLCIyNDkiOjE4NSwiMjUwIjoxNzEsIjI1MSI6OTYsIjI1MiI6NDQsIjI1MyI6MjA0LCIyNTQiOjEwMCwiMjU1IjoyMDMsIjI1NiI6MTE2LCIyNTciOjExMywiMjU4IjoyNDIsIjI1OSI6MTkwLCIyNjAiOjExNCwiMjYxIjoxMiwiMjYyIjoxMTQsIjI2MyI6MTYsIjI2NCI6MTg0LCIyNjUiOjIxNSwiMjY2IjoyNTQsIjI2NyI6MTMwLCIyNjgiOjQsIjI2OSI6ODgsIjI3MCI6MzIsIjI3MSI6MTcyLCIyNzIiOjk1LCIyNzMiOjEzOSwiMjc0Ijo0MCwiMjc1IjoyMDQsIjI3NiI6MjExLCIyNzciOjQ4LCIyNzgiOjQ4LCIyNzkiOjE4NiwiMjgwIjoxNzQsIjI4MSI6MTIyLCIyODIiOjExMCwiMjgzIjoxOTAsIjI4NCI6MjA2LCIyODUiOjExLCIyODYiOjE1MCwiMjg3Ijo5MSwiMjg4IjoxOSwiMjg5Ijo2OSwiMjkwIjo2LCIyOTEiOjM4LCIyOTIiOjI0NCwiMjkzIjoxNTYsIjI5NCI6NTMsIjI5NSI6MjIxLCIyOTYiOjIxMiwiMjk3IjoxNzEsIjI5OCI6MTAyLCIyOTkiOjc3LCIzMDAiOjE5OSwiMzAxIjoyMDMsIjMwMiI6NTUsIjMwMyI6MTMwLCIzMDQiOjQsIjMwNSI6ODgsIjMwNiI6MzIsIjMwNyI6NiwiMzA4IjoyNDYsIjMwOSI6MTA1LCIzMTAiOjExOCwiMzExIjoxMjcsIjMxMiI6MTksIjMxMyI6MjMwLCIzMTQiOjE5NCwiMzE1IjoxNTksIjMxNiI6NDUsIjMxNyI6ODMsIjMxOCI6MTQzLCIzMTkiOjEyNCwiMzIwIjoxMDgsIjMyMSI6MTA3LCIzMjIiOjE1OSwiMzIzIjo2NSwiMzI0Ijo4NCwiMzI1IjoxNSwiMzI2IjoyMDcsIjMyNyI6NDIsIjMyOCI6MjQ2LCIzMjkiOjIxMCwiMzMwIjo3MCwiMzMxIjoxMTksIjMzMiI6MTg1LCIzMzMiOjEwMCwiMzM0IjoyMiwiMzM1IjoxNjEsIjMzNiI6MjgsIjMzNyI6MTQyLCIzMzgiOjE0OSwiMzM5IjoxMzAsIjM0MCI6NCwiMzQxIjo4OCwiMzQyIjozMiwiMzQzIjoyMDksIjM0NCI6MjMwLCIzNDUiOjIyNywiMzQ2Ijo4MSwiMzQ3IjoxMTQsIjM0OCI6MTU4LCIzNDkiOjIyOCwiMzUwIjoxODMsIjM1MSI6MTAzLCIzNTIiOjE0MSwiMzUzIjoxNDEsIjM1NCI6MjA0LCIzNTUiOjI0LCIzNTYiOjUsIjM1NyI6OTYsIjM1OCI6MzUsIjM1OSI6ODcsIjM2MCI6MTgyLCIzNjEiOjIwLCIzNjIiOjIyMywiMzYzIjoxODEsIjM2NCI6MjI5LCIzNjUiOjIzMiwiMzY2IjoyNTAsIjM2NyI6MTIzLCIzNjgiOjE5MSwiMzY5IjoyNDUsIjM3MCI6MjAxLCIzNzEiOjIwNCwiMzcyIjoyNDksIjM3MyI6MTA0LCIzNzQiOjMyLCIzNzUiOjEzMCwiMzc2Ijo0LCIzNzciOjg4LCIzNzgiOjMyLCIzNzkiOjEyOSwiMzgwIjoxMzEsIjM4MSI6MjEsIjM4MiI6MjE3LCIzODMiOjE1NSwiMzg0IjoyNDUsIjM4NSI6MTQ5LCIzODYiOjIwMCwiMzg3IjoxNDAsIjM4OCI6MTY0LCIzODkiOjExMywiMzkwIjo3NywiMzkxIjoxNDAsIjM5MiI6MzYsIjM5MyI6MTI1LCIzOTQiOjE2NSwiMzk1Ijo2MCwiMzk2IjoyNTMsIjM5NyI6MTAwLCIzOTgiOjE3OCwiMzk5IjoyMDcsIjQwMCI6MjE5LCI0MDEiOjIxMywiNDAyIjo4NiwiNDAzIjoxNzIsIjQwNCI6MzIsIjQwNSI6MzMsIjQwNiI6MTg4LCI0MDciOjksIjQwOCI6MTI4LCI0MDkiOjcyLCI0MTAiOjY2LCI0MTEiOjEzMSwiNDEyIjoxLCI0MTMiOjEzMCwiNDE0Ijo0LCI0MTUiOjg4LCI0MTYiOjMyLCI0MTciOjI1MCwiNDE4Ijo3MywiNDE5IjoxMjIsIjQyMCI6MjksIjQyMSI6MTcwLCI0MjIiOjIxNiwiNDIzIjoxNjUsIjQyNCI6MTI0LCI0MjUiOjk5LCI0MjYiOjE1OCwiNDI3Ijo4NywiNDI4IjowLCI0MjkiOjIxNCwiNDMwIjo1LCI0MzEiOjgxLCI0MzIiOjExLCI0MzMiOjE2NSwiNDM0IjoyMzQsIjQzNSI6MTkxLCI0MzYiOjQzLCI0MzciOjExNywiNDM4IjoxMjEsIjQzOSI6MTE1LCI0NDAiOjEyOCwiNDQxIjoxNzIsIjQ0MiI6MTgzLCI0NDMiOjUxLCI0NDQiOjE1LCI0NDUiOjQ0LCI0NDYiOjE3OCwiNDQ3IjoyLCI0NDgiOjQzLCI0NDkiOjEzMSwiNDUwIjoyLCI0NTEiOjY4LCI0NTIiOjExNiwiNDUzIjoxMDUsIjQ1NCI6MTA5LCI0NTUiOjEwMSwiNDU2IjoxMzAsIjQ1NyI6MywiNDU4Ijo3MywiNDU5IjoxNDEsIjQ2MCI6MTMzLCI0NjEiOjIxNSwiNDYyIjoyMjAsIjQ2MyI6MjI0LCI0NjQiOjE2MSwiNDY1IjoxNzMsIjQ2NiI6MjM1LCI0NjciOjIzLCI0NjgiOjEwNSwiNDY5IjoxMTUsIjQ3MCI6MTA1LCI0NzEiOjEwMywiNDcyIjoxMTAsIjQ3MyI6OTcsIjQ3NCI6MTE2LCI0NzUiOjExNywiNDc2IjoxMTQsIjQ3NyI6MTAxLCI0NzgiOjg4LCI0NzkiOjQ4LCI0ODAiOjE2NiwiNDgxIjo2NSwiNDgyIjoyMjAsIjQ4MyI6MTE2LCI0ODQiOjE3OSwiNDg1IjoxNzksIjQ4NiI6MjEzLCI0ODciOjQzLCI0ODgiOjc4LCI0ODkiOjkxLCI0OTAiOjkzLCI0OTEiOjI1LCI0OTIiOjIyNCwiNDkzIjoyMjMsIjQ5NCI6MjI1LCI0OTUiOjEzMiwiNDk2IjoxNjksIjQ5NyI6NDcsIjQ5OCI6MTEzLCI0OTkiOjEwMSwiNTAwIjoxMTMsIjUwMSI6MTc1LCI1MDIiOjE5NiwiNTAzIjoxMTQsIjUwNCI6MTc2LCI1MDUiOjMxLCI1MDYiOjI4LCI1MDciOjk5LCI1MDgiOjIyNywiNTA5IjoxOSwiNTEwIjoyNSwiNTExIjoxMjAsIjUxMiI6MjI2LCI1MTMiOjIzNiwiNTE0IjoyNDAsIjUxNSI6NjIsIjUxNiI6MTIwLCI1MTciOjEzNSwiNTE4Ijo0MiwiNTE5IjoyMTUsIjUyMCI6NzgsIjUyMSI6MjMxLCI1MjIiOjEyMCwiNTIzIjoxMSwiNTI0IjoxMTEsIjUyNSI6MjM2LCI1MjYiOjIyNCwiNTI3IjoyMzgsIjUyOCI6MTAwLCI1MjkiOjExNiwiNTMwIjoxMTQsIjUzMSI6MTAxLCI1MzIiOjEwMSwiNTMzIjoxMzEsIjUzNCI6MSwiNTM1IjoxMzAsIjUzNiI6NCwiNTM3Ijo4OCwiNTM4IjozMiwiNTM5IjoxNTQsIjU0MCI6MTUzLCI1NDEiOjEwMCwiNTQyIjoyMDYsIjU0MyI6MjI4LCI1NDQiOjEwMCwiNTQ1IjoxMzEsIjU0NiI6MjIsIjU0NyI6OTYsIjU0OCI6MjIsIjU0OSI6MjM1LCI1NTAiOjEwNywiNTUxIjoxNTcsIjU1MiI6NzAsIjU1MyI6MTA5LCI1NTQiOjI2LCI1NTUiOjExMiwiNTU2IjoxNywiNTU3IjoxMzEsIjU1OCI6MjM5LCI1NTkiOjE1NCwiNTYwIjoxNzUsIjU2MSI6MSwiNTYyIjoxMDMsIjU2MyI6MTMzLCI1NjQiOjI0OCwiNTY1IjoxMTksIjU2NiI6MTE4LCI1NjciOjIzMSwiNTY4Ijo2OCwiNTY5IjoxNDcsIjU3MCI6NzksIjU3MSI6MTMxLCI1NzIiOjIsIjU3MyI6NjcsIjU3NCI6MTE1LCI1NzUiOjEwNSwiNTc2IjoxMDMsIjU3NyI6MTMxLCI1NzgiOjIsIjU3OSI6ODgsIjU4MCI6MzIsIjU4MSI6MTU1LCI1ODIiOjIyNywiNTgzIjoyMDMsIjU4NCI6NDQsIjU4NSI6MjQwLCI1ODYiOjE3MiwiNTg3IjoxMywiNTg4IjoxNzYsIjU4OSI6MTAzLCI1OTAiOjIxNSwiNTkxIjo0MiwiNTkyIjo1MywiNTkzIjozNSwiNTk0IjoxNTksIjU5NSI6OTYsIjU5NiI6MTQ2LCI1OTciOjIxMCwiNTk4IjoxNDYsIjU5OSI6MjQxLCI2MDAiOjI0NiwiNjAxIjoxODQsIjYwMiI6MTM1LCI2MDMiOjM1LCI2MDQiOjIyMCwiNjA1Ijo3NywiNjA2IjoyMjMsIjYwNyI6MTkwLCI2MDgiOjg5LCI2MDkiOjEwLCI2MTAiOjIxNywiNjExIjoxNTUsIjYxMiI6NTksIjYxMyI6MTMxLCI2MTQiOjEsIjYxNSI6MTMwLCI2MTYiOjQsIjYxNyI6ODgsIjYxOCI6MzIsIjYxOSI6ODAsIjYyMCI6MTgsIjYyMSI6MTk0LCI2MjIiOjE5NSwiNjIzIjoyNTIsIjYyNCI6MiwiNjI1IjoxODksIjYyNiI6MTk5LCI2MjciOjE2OSwiNjI4IjoyNDAsIjYyOSI6MjEsIjYzMCI6MTM4LCI2MzEiOjEyMSwiNjMyIjozOCwiNjMzIjoxMDksIjYzNCI6MzMsIjYzNSI6MTQ2LCI2MzYiOjg2LCI2MzciOjYwLCI2MzgiOjEyOSwiNjM5IjoxNzUsIjY0MCI6ODQsIjY0MSI6MjM3LCI2NDIiOjUyLCI2NDMiOjIyMCwiNjQ0IjoxODAsIjY0NSI6MjE5LCI2NDYiOjE4NywiNjQ3IjoxMCwiNjQ4Ijo4NywiNjQ5IjoxOTAsIjY1MCI6MTM5LCI2NTEiOjEzMSwiNjUyIjoyLCI2NTMiOjg4LCI2NTQiOjMyLCI2NTUiOjE5OSwiNjU2Ijo5LCI2NTciOjEwNiwiNjU4IjoyMDIsIjY1OSI6MTc5LCI2NjAiOjEwNSwiNjYxIjoyMDYsIjY2MiI6MjU1LCI2NjMiOjcyLCI2NjQiOjQ4LCI2NjUiOjMxLCI2NjYiOjEwOCwiNjY3Ijo5NCwiNjY4IjoyMTUsIjY2OSI6MjgsIjY3MCI6MjA3LCI2NzEiOjIxMiwiNjcyIjoyNTMsIjY3MyI6MjQ0LCI2NzQiOjk0LCI2NzUiOjExOCwiNjc2IjoxMTIsIjY3NyI6MjAxLCI2NzgiOjE1MywiNjc5Ijo3NCwiNjgwIjoxMzAsIjY4MSI6MTU2LCI2ODIiOjEyNCwiNjgzIjo4NiwiNjg0Ijo5OSwiNjg1IjoyMywiNjg2IjoyMjcsIjY4NyI6MTMwLCI2ODgiOjMsIjY4OSI6NjR9fQ==';
const currentTimeNsOverride = BigInt(0);
const iiCanisterIdOverride = 'aovwi-4maaa-aaaaa-qaagq-cai';

const expired = {
  address: '0x33A17d5f19827EB220a3C05e33E5678A8b7b45Eb',
  proof:
    'eyJleHBpcmVzIjoiMjAyMy0wNS0wNFQxMzoyODoxNy45MThaIiwibWVzc2FnZSI6InRlc3QifQ==.MHhiMmEyZmQ5MWFiMDNkYzQwN2UwMjIxZDdhMjVlOGY5ZDIzNmI5Y2U1NGYxODA1MDVjYjE2NWYwMmMyMDQxMTBkNzhkNDRhMTQzMWY4NTI3YWY2OGZjZTg1MWRjZmI2ZDcwYzA5NjVmN2FlNGM2NWYyYjcwZDRkOWU4MjBlOWRiOTFj',
};

describe('prove-icp-principal', () => {
  afterEach(() => jest.restoreAllMocks());

  let message: string;
  beforeEach(() => {
    message = JSON.stringify(messageFixture);
  });

  it('creates a wallet ownership proof when a signer function is provided', async () => {
    // const proof = await create({
    //   message,
    // });
    // expect(proof).toMatch(/.*\..*/); // the message is a base64 version of the signature concatenated with the message
  });

  it('verifies wallet ownership with provided signer function', async () => {
    await expect(verify('undefined', proofJWTFixture, { message }, currentTimeNsOverride, iiCanisterIdOverride)).resolves.not.toThrow();
  });

  // it('throws an error if the transaction is signed with a different key', async () => {
  //   const someOtherKey = Wallet.createRandom();

  //   const proof = await create({
  //     message,
  //   });
  //   await expect(verify(someOtherKey.address, proof, { message })).rejects.toThrow();
  // });

  // it('throws an error if the proof is expired', async () => {
  //   await expect(verify(expired.address, expired.proof, { message: 'test' })).rejects.toThrow('Token Expired');
  // });

  // it("throws an error if the message doesn't match", async () => {
  //   const proof = await create({
  //     message: 'bad',
  //   });
  //   await expect(verify(wallet.address, proof, { message: 'test' })).rejects.toThrow('Bad message');
  // });
});